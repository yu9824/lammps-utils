

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lammps_utils.graph package &mdash; lammps-utils 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="lammps_utils.io package" href="lammps_utils.io.html" />
    <link rel="prev" title="lammps_utils package" href="lammps_utils.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            lammps-utils
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">lammps_utils</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="lammps_utils.html">lammps_utils package</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="lammps_utils.html#lammps-utilities">LAMMPS Utilities</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="lammps_utils.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">lammps_utils.graph package</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammps_utils.io.html">lammps_utils.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammps_utils.logging.html">lammps_utils.logging package</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammps_utils.rdkit.html">lammps_utils.rdkit package</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammps_utils.smooth.html">lammps_utils.smooth package</a></li>
<li class="toctree-l4"><a class="reference internal" href="lammps_utils.utils.html">lammps_utils.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="lammps_utils.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="lammps_utils.html#module-lammps_utils.constants">lammps_utils.constants module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">lammps-utils</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">lammps_utils</a></li>
          <li class="breadcrumb-item"><a href="lammps_utils.html">lammps_utils package</a></li>
      <li class="breadcrumb-item active">lammps_utils.graph package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lammps_utils.graph.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-lammps_utils.graph">
<span id="lammps-utils-graph-package"></span><h1>lammps_utils.graph package<a class="headerlink" href="#module-lammps_utils.graph" title="Link to this heading"></a></h1>
<p>Graph utilities for molecular structures.</p>
<p>This submodule provides functions for:
- Finding the farthest-apart atoms in a molecular graph,
- Identifying atoms that are part of ring structures,
- Unwrapping molecular coordinates under periodic boundary conditions (PBC).</p>
<dl class="py function">
<dt class="sig sig-object py" id="lammps_utils.graph.farthest_node_pair">
<span class="sig-prename descclassname"><span class="pre">lammps_utils.graph.</span></span><span class="sig-name descname"><span class="pre">farthest_node_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_nodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Generator</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lammps_utils.graph.farthest_node_pair" title="Link to this definition"></a></dt>
<dd><p>Finds the farthest node pair in each connected component of the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>nx.Graph</em>) – The input graph.</p></li>
<li><p><strong>ignore_nodes</strong> (<em>set</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Set of nodes to ignore during the search, by default an empty set.</p></li>
<li><p><strong>return_length</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to return the maximum distance along with the node pair, by default False.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><em>Union[</em></p></li>
<li><p><em>Generator[tuple[int, int], None, None],</em></p></li>
<li><p><em>Generator[tuple[tuple[int, int], int], None, None]</em></p></li>
<li><p><em>]</em> – Yields tuples of farthest node pairs. If <cite>return_length</cite> is True,
the second value in the tuple is the maximum distance.</p></li>
</ul>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If no valid pair is found in any connected component.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lammps_utils.graph.nodes_in_cycles">
<span class="sig-prename descclassname"><span class="pre">lammps_utils.graph.</span></span><span class="sig-name descname"><span class="pre">nodes_in_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#lammps_utils.graph.nodes_in_cycles" title="Link to this definition"></a></dt>
<dd><p>Returns nodes that belong to cycles in the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong> (<em>nx.Graph</em>) – The input undirected graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A set of node identifiers that belong to cycles in the graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>set[int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lammps_utils.graph.unwrap_molecule_under_pbc">
<span class="sig-prename descclassname"><span class="pre">lammps_utils.graph.</span></span><span class="sig-name descname"><span class="pre">unwrap_molecule_under_pbc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Buffer</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#lammps_utils.graph.unwrap_molecule_under_pbc" title="Link to this definition"></a></dt>
<dd><p>Unwrap molecular coordinates under periodic boundary conditions (PBC).</p>
<p>This function traverses the molecular graph and adjusts atomic positions so that
bonded atoms are placed close together, eliminating jumps caused by PBC wrapping.
It operates independently on each connected component of the graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>graph</strong> (<em>nx.Graph</em>) – A molecular graph where nodes correspond to atoms and edges represent bonds.
Each connected component is treated as an independent molecule or fragment.</p></li>
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – A (N, 3) array of atomic coordinates, where N is the number of atoms.</p></li>
<li><p><strong>cell_size</strong> (<em>ArrayLike</em>) – A 1D array-like of length 3 specifying the dimensions of the periodic simulation box.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A (N, 3) NumPy array of unwrapped atomic coordinates. The coordinates are adjusted
such that bonded atoms are positioned contiguously within the same image of the unit cell.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AssertionError</strong> – If input dimensions are invalid or if the number of atoms in <cite>graph</cite> and <cite>positions</cite> do not match.</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method assumes that atoms are initially located within the same periodic image, and it
corrects discontinuities across periodic boundaries by walking through the molecular graph
using a breadth-first traversal.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lammps_utils.graph.wrap_positions_to_cell">
<span class="sig-prename descclassname"><span class="pre">lammps_utils.graph.</span></span><span class="sig-name descname"><span class="pre">wrap_positions_to_cell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="headerlink" href="#lammps_utils.graph.wrap_positions_to_cell" title="Link to this definition"></a></dt>
<dd><p>Wrap 3D positions into a periodic simulation cell.</p>
<p>This function takes an array of 3D Cartesian coordinates and wraps each
position into the simulation cell defined by the given bounds using
periodic boundary conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positions</strong> (<em>np.ndarray</em>) – A NumPy array of shape (N, 3) representing the positions of N atoms.</p></li>
<li><p><strong>cell_bounds</strong> (<em>tuple</em><em> or </em><em>np.ndarray</em>) – The simulation cell bounds. Can be provided as a tuple of
((xlo, xhi), (ylo, yhi), (zlo, zhi)) or a NumPy array of shape (3, 2).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A NumPy array of shape (N, 3) containing the wrapped positions.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="lammps_utils.html" class="btn btn-neutral float-left" title="lammps_utils package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="lammps_utils.io.html" class="btn btn-neutral float-right" title="lammps_utils.io package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, yu9824.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>